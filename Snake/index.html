<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Snake 貪吃蛇</title>
  <style>
    :root {
      --bg: #0f1220;
      --panel: #14182b;
      --accent: #5cf2a6;
      --accent-2: #6aa8ff;
      --danger: #ff6b6b;
      --grid: #1e2340;
      --text: #e9edf8;
      --muted: #9aa3b2;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; overscroll-behavior: none; }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 10% 10%, #151936 0%, var(--bg) 45%),
                  radial-gradient(1000px 800px at 90% 10%, #182042 0%, var(--bg) 50%),
                  var(--bg);
      color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans TC, Helvetica, Arial, sans-serif;
      display: grid; place-items: center; padding: 12px; min-height: 100dvh; overflow: hidden;
    }
    .card {
      width: min(94vw, 900px);
      height: calc(100dvh - 24px);
      max-height: 860px;
      background: linear-gradient(180deg, #161c38 0%, #0e1330 100%);
      border: 1px solid #1e2449; border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.04);
      padding: 14px; position: relative; overflow: hidden;
      display: flex; flex-direction: column;
    }
    header {
      display: flex; flex-direction: column; align-items: center; gap: 6px;
      padding: 6px; border-bottom: 1px dashed #26305e;
    }
    h1 { font-size: 20px; margin: 0; letter-spacing: .5px; }
    .credit { font-size: 12px; color: var(--muted); }
    .stats { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; justify-content: center; }
    .pill { background: #101535; border: 1px solid #2a376d; color: var(--text); padding: 6px 10px; border-radius: 999px; font-size: 12px; min-width: 92px; text-align: center; }
    .pill strong { color: var(--accent); }
    .controls { display: flex; gap: 6px; flex-wrap: wrap; justify-content: center; }
    button {
      appearance: none; border: 1px solid #2a376d; background: #0e1433; color: var(--text); cursor: pointer;
      padding: 8px 10px; border-radius: 10px; font-weight: 600; letter-spacing: .2px; font-size: 13px;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    button:hover { background: #111a44; }
    button:active { transform: translateY(1px); }
    .primary { border-color: #2b6f66; background: linear-gradient(180deg, #0c2b27, #0b1f1d); }
    .danger { border-color: #5a2634; background: linear-gradient(180deg, #2b0c16, #1d0b11); }

    .wrap { flex: 1; display: flex; flex-direction: column; justify-content: space-between; gap: 10px; padding-top: 10px; }
    .board { position: relative; flex: 1; background: #0b102a; border-radius: 16px; overflow: hidden; border: 1px solid #1b2348; box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); }
    .board::before { content: ""; display: block; padding-bottom: 100%; }
    canvas { position: absolute; inset: 0; width: 100%; height: 100%; display: block; }

    .overlay {
      position: absolute; inset: 0; display: none; align-items: center; justify-content: center; flex-direction: column;
      background: radial-gradient(400px 300px at 50% 40%, rgba(20,25,60,.7), rgba(10,14,35,.85));
      color: var(--text); text-align: center; padding: 24px; gap: 14px; cursor: pointer;
      touch-action: manipulation;
    }
    .overlay.show { display: flex; }
    .overlay h2 { margin: 0; font-size: 22px; }
    .hint { font-size: 12px; color: var(--muted); }

    /* Glow Joystick */
    .joystick { position: absolute; left: 50%; bottom: max(16px, env(safe-area-inset-bottom)); transform: translateX(-50%);
      width: 140px; height: 140px; border-radius: 50%;
      background: radial-gradient(60% 60% at 50% 45%, #10183e 0%, #0c1333 60%, #0a0f2c 100%);
      border: 2px solid #2a376d; box-shadow: 0 0 25px rgba(106,168,255,.25), inset 0 0 18px rgba(92,242,166,.12);
      touch-action: none; user-select: none; overflow: visible; z-index: 20;
    }
    .joystick::before { content: ""; position: absolute; inset: -6px; border-radius: 50%; background: conic-gradient(from 0deg, rgba(106,168,255,.0), rgba(106,168,255,.45), rgba(92,242,166,.45), rgba(106,168,255,.0)); filter: blur(10px); opacity: .8; pointer-events: none; }
    .stick { position: absolute; left: 50%; top: 50%; width: 64px; height: 64px; border-radius: 50%; transform: translate(-50%, -50%);
      background: radial-gradient(70% 70% at 40% 35%, #7bf7bf 0%, #5cf2a6 40%, #39c18a 100%); box-shadow: 0 0 22px rgba(92,242,166,.65), inset 0 8px 16px rgba(255,255,255,.2); border: 2px solid rgba(92,242,166,.7); transition: transform .05s linear; pointer-events: none; }

    .list { margin: 6px auto 0; padding: 8px; border: 1px dashed #26305e; border-radius: 12px; font-size: 12px; color: var(--muted); max-width: 92%; }
    .list ol { margin: 6px 0 0 18px; }
  </style>
</head>
<body>
  <div class="card">
    <header>
      <h1>Snake 貪吃蛇</h1>
      <div class="credit">創作者：LIAN CHENG｜方向鍵 / WASD / 搖桿</div>
      <div class="stats">
        <div class="pill">分數：<strong id="score">0</strong></div>
        <div class="pill">最佳：<strong id="best">0</strong></div>
      </div>
      <div class="controls">
        <button id="startBtn" class="primary">開始</button>
        <button id="restartBtn" class="danger">重玩</button>
        <button id="shareBtn">分享成績</button>
      </div>
      <div class="list">
        高分紀錄（前五）
        <ol id="lb"></ol>
      </div>
    </header>

    <div class="wrap">
      <div class="board">
        <canvas id="game" width="600" height="600" aria-label="遊戲畫布"></canvas>
        <div id="overlay" class="overlay" role="dialog" aria-live="polite">
          <h2 id="overlayTitle">點這裡或按「開始」開始遊戲</h2>
          <div class="hint">操作：方向鍵 / WASD / 下方發光搖桿</div>
          <div>
            <button id="resumeBtn" class="primary">開始</button>
            <button id="againBtn">重玩</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="joystick" id="joystick"><div class="stick" id="stick"></div></div>

  <script>
    // 保留之前的完整遊戲程式碼（不變動邏輯，只修改搖桿位置 & 高分紀錄位置）
  </script>
</body>
</html>
